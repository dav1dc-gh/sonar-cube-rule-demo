{
  "key": "csrf-vulnerability",
  "name": "Cross-Site Request Forgery (CSRF)",
  "description": "Detects missing CSRF protection on state-changing operations, which could allow attackers to trick users into performing unintended actions.",
  "severity": "MAJOR",
  "type": "VULNERABILITY",
  "tags": ["security", "csrf", "owasp-top-10", "web"],
  "remediation": {
    "constantCost": "30min",
    "examples": [
      {
        "before": "@PostMapping(\"/transfer\")\npublic void transfer(@RequestBody TransferRequest request) {\n  // No CSRF token validation\n}",
        "after": "@PostMapping(\"/transfer\")\npublic void transfer(@RequestBody TransferRequest request, @RequestHeader(\"X-CSRF-TOKEN\") String csrfToken) {\n  csrfService.validateToken(csrfToken);\n  // Process transfer\n}"
      }
    ]
  },
  "impacts": [
    {
      "softwareQuality": "SECURITY",
      "severity": "MEDIUM"
    }
  ],
  "defaultSeverity": "MAJOR",
  "status": "READY",
  "debt": {
    "function": "CONSTANT_ISSUE",
    "offset": "30min"
  }
}
